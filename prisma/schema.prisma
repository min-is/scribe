// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Provider {
  id        String   @id @default(cuid())
  slug      String   @unique
  name      String
  credentials String?

  // Difficulty Metrics (1-10 scale)
  generalDifficulty     Int?  // Primary metric shown in preview
  speedDifficulty       Int?  // How fast they work
  terminologyDifficulty Int?  // Terminology expectations
  noteDifficulty        Int?  // Note complexity requirements

  // Preferences
  noteTemplate String?
  noteSmartPhrase String?
  preferences  Json?      // Legacy JSON field
  wikiContent  Json?      // Rich wiki-style content (WikiContent schema)

  // Analytics
  viewCount        Int @default(0)  // Profile view tracking
  searchClickCount Int @default(0)  // Search click tracking

  // Metadata
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([slug])
  @@index([viewCount])
  @@index([searchClickCount])
}

model SmartPhrase {
  id          String   @id @default(cuid())
  slug        String   @unique  // The dot phrase itself (e.g., ".PEABD")
  title       String              // Display name (e.g., "Physical Exam - Abdomen")
  category    String              // Category (e.g., "Physical Exam", "HPI", "MDM")
  description String?             // Brief description
  content     String              // Full text of the smartphrase
  tags        String[]            // Additional searchable tags

  // Analytics
  usageCount  Int      @default(0)  // Track how often it's copied

  // Metadata
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([category])
  @@index([slug])
  @@index([usageCount])
}

model Scenario {
  id          String   @id @default(cuid())
  slug        String   @unique  // URL-friendly identifier (e.g., "code-blue")
  title       String              // Display name (e.g., "Code Blue Response")
  category    String              // Category (e.g., "Emergency", "Cardiac", "Neuro")
  description String?             // Brief overview
  content     String              // Detailed walkthrough/steps in markdown or plain text
  tags        String[]            // Additional searchable tags

  // Analytics
  viewCount   Int      @default(0)  // Track how often it's viewed

  // Metadata
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([category])
  @@index([slug])
  @@index([viewCount])
}

model Procedure {
  id          String   @id @default(cuid())
  slug        String   @unique  // URL-friendly identifier (e.g., "lumbar-puncture")
  title       String              // Display name (e.g., "Lumbar Puncture")
  category    String              // Category (e.g., "Neurology", "Emergency", "ICU")
  description String?             // Brief overview
  indications String?             // When to perform this procedure
  contraindications String?       // When NOT to perform this procedure
  equipment   String?             // Required equipment/supplies
  steps       String              // Step-by-step instructions
  complications String?           // Potential complications
  tags        String[]            // Additional searchable tags

  // Analytics
  viewCount   Int      @default(0)  // Track how often it's viewed

  // Metadata
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([category])
  @@index([slug])
  @@index([viewCount])
}
